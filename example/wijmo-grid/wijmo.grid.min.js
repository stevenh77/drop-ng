/*
    *
    * Wijmo Library 5.20143.26
    * http://wijmo.com/
    *
    * Copyright(c) GrapeCity, Inc.  All rights reserved.
    * 
    * Licensed under the Wijmo Commercial License. 
    * sales@wijmo.com
    * http://wijmo.com/products/wijmo-5/license/
    *
    */
var __extends=this.__extends||function(n,t){function r(){this.constructor=n}for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);r.prototype=t.prototype;n.prototype=new r},wijmo;wijmo.culture.FlexGrid={groupHeaderFormat:"{name}: <b>{value} <\/b>({count} items)"},function(n){(function(t){"use strict";(function(n){n[n.None=0]="None";n[n.Column=1]="Column";n[n.Row=2]="Row";n[n.All=3]="All"})(t.HeadersVisibility||(t.HeadersVisibility={}));var i=t.HeadersVisibility,r=function(r){function u(i,u){r.call(this,i,null,!0);this._szClient=new n.Size(0,0);this._ptScrl=new n.Point(0,0);this._rtl=!1;this._autoGenCols=!0;this._autoClipboard=!0;this._readOnly=!1;this._indent=14;this._allowResizing=1;this._allowDragging=1;this._hdrVis=3;this._alSorting=!0;this._alAddNew=!1;this._alDelete=!1;this._alMerging=0;this._shSort=!0;this._shGroups=!0;this.itemsSourceChanged=new n.Event;this.scrollPositionChanged=new n.Event;this.selectionChanging=new n.Event;this.selectionChanged=new n.Event;this.loadingRows=new n.Event;this.loadedRows=new n.Event;this.resizingColumn=new n.Event;this.resizedColumn=new n.Event;this.draggingColumn=new n.Event;this.draggedColumn=new n.Event;this.resizingRow=new n.Event;this.resizedRow=new n.Event;this.draggingRow=new n.Event;this.draggedRow=new n.Event;this.groupCollapsedChanging=new n.Event;this.groupCollapsedChanged=new n.Event;this.sortingColumn=new n.Event;this.sortedColumn=new n.Event;this.beginningEdit=new n.Event;this.prepareCellForEdit=new n.Event;this.cellEditEnding=new n.Event;this.cellEditEnded=new n.Event;this.rowEditEnding=new n.Event;this.rowEditEnded=new n.Event;this.rowAdded=new n.Event;this.deletingRow=new n.Event;this.copying=new n.Event;this.copied=new n.Event;this.pasting=new n.Event;this.pasted=new n.Event;var s=i,f=this,o=getComputedStyle(this.hostElement),e=parseInt(o.fontSize)*2;this._isChrome=!!window.chrome;this._isIE=!!document.documentMode;this.deferUpdate(function(){f._rows=new t.RowCollection(f,e);f._cols=new t.ColumnCollection(f,e*4);f._hdrRows=new t.RowCollection(f,e);f._hdrCols=new t.ColumnCollection(f,Math.round(e*1.25));f._hdrRows.push(new t.Row);f._hdrCols.push(new t.Column);f._hdrCols[0].align="center";f._createChildren();f._cf=new t.CellFactory;f._keyHdl=new t._KeyboardHandler(f);f._mouseHdl=new t._MouseHandler(f);f._edtHdl=new t._EditHandler(f);f._selHdl=new t._SelectionHandler(f);f._addHdl=new t._AddNewHandler(f);f._mrgMgr=new t.MergeManager(f);f.initialize(u)});this._root.addEventListener("scroll",function(){var t=f._root,r=t.scrollTop,i=-f._ptScrl.x;r==-f._ptScrl.y&&(i=t.scrollLeft);f._rtl&&f._isChrome&&(i=t.scrollWidth-t.clientWidth-i);f._ptScrl=new n.Point(-Math.abs(i),-r);f._updateContent(!0);f.onScrollPositionChanged()})}return __extends(u,r),Object.defineProperty(u.prototype,"headersVisibility",{get:function(){return this._hdrVis},set:function(t){t!=this._hdrVis&&(this._hdrVis=n.asEnum(t,i),this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"autoGenerateColumns",{get:function(){return this._autoGenCols},set:function(t){this._autoGenCols=n.asBoolean(t)},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"autoClipboard",{get:function(){return this._autoClipboard},set:function(t){this._autoClipboard=n.asBoolean(t)},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"columnLayout",{get:function(){for(var c,o,i,r,f,s=u._getSerializableProperties(t.Column),l=new t.Column,h=[],e=0;e<this.columns.length;e++){for(c=this.columns[e],o={},i=0;i<s.length;i++)r=s[i],f=c[r],f!=l[r]&&n.isPrimitive(f)&&(o[r]=f);h.push(o)}return JSON.stringify({columns:h})},set:function(t){var i=JSON.parse(n.asString(t));if(!i||i.columns==null)throw"Invalid columnLayout data.";this.columns.clear();this.initialize(i)},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"isReadOnly",{get:function(){return this._readOnly},set:function(t){t!=this._readOnly&&(this._readOnly=n.asBoolean(t),this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"allowResizing",{get:function(){return this._allowResizing},set:function(i){this._allowResizing=n.asEnum(i,t.AllowResizing)},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"allowSorting",{get:function(){return this._alSorting},set:function(t){this._alSorting=n.asBoolean(t)},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"allowAddNew",{get:function(){return this._alAddNew},set:function(t){t!=this._alAddNew&&(this._alAddNew=n.asBoolean(t),this._addHdl.updateNewRowTemplate())},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"allowDelete",{get:function(){return this._alDelete},set:function(t){t!=this._alDelete&&(this._alDelete=n.asBoolean(t))},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"allowMerging",{get:function(){return this._alMerging},set:function(i){i!=this._alMerging&&(this._alMerging=n.asEnum(i,t.AllowMerging),this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"showSort",{get:function(){return this._shSort},set:function(t){t!=this._shSort&&(this._shSort=n.asBoolean(t),this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"showGroups",{get:function(){return this._shGroups},set:function(t){t!=this._shGroups&&(this._shGroups=n.asBoolean(t),this._bindGrid(!1))},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"groupHeaderFormat",{get:function(){return this._gHdrFmt},set:function(t){t!=this._gHdrFmt&&(this._gHdrFmt=n.asString(t),this._bindGrid(!1))},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"allowDragging",{get:function(){return this._allowDragging},set:function(i){i!=this._allowDragging&&(this._allowDragging=n.asEnum(i,t.AllowDragging),this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"itemsSource",{get:function(){return this._items},set:function(t){this._items!=t&&(this._cv&&(this._cv.currentChanged.removeHandler(this._cvCurrentChanged,this),this._cv.collectionChanged.removeHandler(this._cvCollectionChanged,this),this._cv=null),this._items=t,this._cv=n.asCollectionView(t),this._lastCount=0,this._cv!=null&&(this._cv.currentChanged.addHandler(this._cvCurrentChanged,this),this._cv.collectionChanged.addHandler(this._cvCollectionChanged,this)),this._bindGrid(!0),this.onItemsSourceChanged())},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"collectionView",{get:function(){return this._cv},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"childItemsPath",{get:function(){return this._childItemsPath},set:function(n){n!=this._childItemsPath&&(this._childItemsPath=n,this._bindGrid(!0))},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"cells",{get:function(){return this._gpCells},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"columnHeaders",{get:function(){return this._gpCHdr},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"rowHeaders",{get:function(){return this._gpRHdr},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"topLeftCells",{get:function(){return this._gpTL},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"rows",{get:function(){return this._rows},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"columns",{get:function(){return this._cols},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"frozenRows",{get:function(){return this.rows.frozen},set:function(n){this.rows.frozen=n},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"frozenColumns",{get:function(){return this.columns.frozen},set:function(n){this.columns.frozen=n},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"scrollPosition",{get:function(){return this._ptScrl.clone()},set:function(n){var t=this._root,i=-n.x;this._rtl&&(i=this._isChrome?t.scrollWidth-t.clientWidth+n.x:this._isIE?-n.x:n.x);t.scrollLeft!=i&&(t.scrollLeft=i);t.scrollTop!=-n.y&&(t.scrollTop=-n.y)},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"clientSize",{get:function(){return this._szClient},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"controlRect",{get:function(){return this._rcBounds||(this._rcBounds=n.getElementRect(this._root)),this._rcBounds},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"scrollSize",{get:function(){return new n.Size(this._gpCells.width,this._heightBrowser)},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"viewRange",{get:function(){return this._gpCells.viewRange},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"cellFactory",{get:function(){return this._cf},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"itemFormatter",{get:function(){return this._itemFormatter},set:function(t){t!=this._itemFormatter&&(this._itemFormatter=n.asFunction(t),this.invalidate())},enumerable:!0,configurable:!0}),u.prototype.getCellData=function(n,t,i){return this.cells.getCellData(n,t,i)},u.prototype.setCellData=function(n,t,i,r){return typeof r=="undefined"&&(r=!0),this.cells.setCellData(n,t,i,r)},u.prototype.hitTest=function(i,r){return n.isNumber(i)&&n.isNumber(r)?i=new n.Point(i,r):i instanceof MouseEvent&&(i=new n.Point(i.pageX,i.pageY)),n.asType(i,n.Point),new t.HitTestInfo(this,i)},u.prototype.getClipString=function(i){var r,u,o,f,e;for(i=i?n.asType(i,t.CellRange):this.selection,r="",u=i.topRow;u<=i.bottomRow;u++)if(this.rows[u].isVisible)for(o=!0,r&&(r+="\n"),f=i.leftCol;f<=i.rightCol;f++)this.columns[f].isVisible&&(o||(r+="\t"),o=!1,e=this.cells.getCellData(u,f,!0).toString(),e=e.replace(/\t/g," "),r+=e);return r},u.prototype.setClipString=function(i,r){var l=r==null,e,u,h,o,c,f,s;for(r=r?n.asType(r,t.CellRange):this.selection,i=n.asString(i).replace(/\r\n/g,"\n").replace(/\r/g,"\n"),i&&i[i.length-1]=="\n"&&(i=i.substring(0,i.length-1)),l&&!r.isSingleCell&&(i=this._expandClipString(i,r)),e=new t.CellRange(r.topRow,r.leftCol),this.beginUpdate(),u=r.topRow,h=i.split("\n"),o=0;o<h.length&&u<this.rows.length;o++,u++){if(!this.rows[u].isVisible){o--;continue}for(c=h[o].split("\t"),f=r.leftCol,s=0;s<c.length&&f<this.columns.length;s++,f++){if(!this.columns[f].isVisible){s--;continue}this.columns[f].isReadOnly||this.rows[u].isReadOnly||(this.cells.setCellData(u,f,c[s]),e.row2=Math.max(e.row2,u),e.col2=Math.max(e.col2,f))}}this.endUpdate();this.collectionView&&this.collectionView.refresh();this.select(e)},u.prototype._expandClipString=function(n,t){var s,r,u,i,f;if(!n)return n;var h=n.split("\n"),o=h.length,e=0,c=[];for(i=0;i<o;i++){if(s=h[i].split("\t"),c.push(s),i>1&&s.length!=e)return n;e=s.length}if(r=t.rowSpan,u=t.columnSpan,(r>1||u>1)&&(r==1&&(r=o),u==1&&(u=e),u%e==0&&r%o==0))for(n="",i=0;i<r;i++)for(f=0;f<u;f++)i>0&&f==0&&(n+="\n"),f>0&&(n+="\t"),n+=c[i%o][f%e];return n},u.prototype.refresh=function(n){typeof n=="undefined"&&(n=!0);r.prototype.refresh.call(this,n);n&&this._updateColumnTypes();this.refreshCells(n)},u.prototype.refreshCells=function(n,t,i){typeof t=="undefined"&&(t=!1);this.isUpdating||(n?this._updateLayout():this._updateContent(t,i))},u.prototype.autoSizeColumn=function(n,t,i){typeof t=="undefined"&&(t=!1);typeof i=="undefined"&&(i=4);this.autoSizeColumns(n,n,t,i)},u.prototype.autoSizeColumns=function(t,i,r,u){typeof r=="undefined"&&(r=!1);typeof u=="undefined"&&(u=4);t=t==null?0:n.asInt(t);i=i==null?this.columns.length-1:n.asInt(t);n.asBoolean(r);n.asNumber(u);var f=this,e=0,s=r?this.topLeftCells:this.columnHeaders,o=r?this.rowHeaders:this.cells,h=this.viewRange,c,l;this.rows.length&&this.columns.length&&(i>this.columns.length-1&&(i=o.columns.length-1),h.row=Math.max(0,h.row-1e3),h.row2=Math.min(h.row2+1e3,this.rows.length-1),this.deferUpdate(function(){var a=n.createElement('<span style="visibility:hidden">'),y,v;for(f.hostElement.appendChild(a),y=t;y<=i;y++){for(e=0,v=0;v<s.rows.length;v++)s.rows[v].isVisible&&(f.cellFactory.updateCell(s,v,y,a),f.itemFormatter&&f.itemFormatter(s,v,y,a),a.style.width=null,e=Math.max(e,a.offsetWidth));for(f.cellFactory.updateCell(o,0,y,a),a.style.width=null,l=null,v=h.row;v<=h.row2;v++)o.rows[v].isVisible&&(!r&&y==o.columns.firstVisibleIndex&&o.rows.maxGroupLevel>-1?(f.cellFactory.updateCell(o,v,y,a),f.itemFormatter&&f.itemFormatter(s,v,y,a),a.style.width=null,e=Math.max(e,a.offsetWidth)):(c=o.getCellData(v,y,!0),c!=l&&(l=c,a.textContent=c,f.itemFormatter&&f.itemFormatter(s,v,y,a),e=Math.max(e,a.offsetWidth))));o.columns[y].width=e+u+2}f.hostElement.removeChild(a)}))},u.prototype.autoSizeRow=function(n,t,i){typeof t=="undefined"&&(t=!1);typeof i=="undefined"&&(i=0);this.autoSizeRows(n,n,t,i)},u.prototype.autoSizeRows=function(t,i,r,u){typeof r=="undefined"&&(r=!1);typeof u=="undefined"&&(u=0);t=t==null?0:n.asInt(t);i=i==null?this.rows.length-1:n.asInt(i);n.asBoolean(r);n.asNumber(u);var f=this,e=0,s=r?this.topLeftCells:this.rowHeaders,o=r?this.columnHeaders:this.cells;this.rows.length&&this.columns.length&&this.deferUpdate(function(){var r=n.createElement('<span style="visibility:hidden">'),c,h,l;for(f.hostElement.appendChild(r),c=t;c<=i;c++){for(e=0,f.cellFactory.updateCell(s,c,0,r),r.style.height=null,h=0;h<s.columns.length;h++)l=s.columns[h].renderSize,l>0&&(r.style.width=l+"px",r.textContent=s.getCellData(c,h,!0),f.itemFormatter&&f.itemFormatter(s,c,h,r),e=Math.max(e,r.offsetHeight));for(f.cellFactory.updateCell(o,c,0,r),r.style.height=null,h=0;h<o.columns.length;h++)l=o.columns[h].renderSize,l>0&&(r.style.width=l+"px",r.textContent=o.getCellData(c,h,!0),f.itemFormatter&&f.itemFormatter(o,c,h,r),e=Math.max(e,r.offsetHeight));o.rows[c].height=e+u}f.hostElement.removeChild(r)})},Object.defineProperty(u.prototype,"treeIndent",{get:function(){return this._indent},set:function(t){t!=this._indent&&(this._indent=n.asNumber(t,!1,!0),this.columns.onCollectionChanged())},enumerable:!0,configurable:!0}),u.prototype.collapseGroupsToLevel=function(i){if(1){var r=this;r.deferUpdate(function(){for(var f,u=0;u<r.rows.length;u++)f=n.tryCast(r.rows[u],t.GroupRow),f&&(f.isCollapsed=f.level>=i)})}},Object.defineProperty(u.prototype,"selectionMode",{get:function(){return this._selHdl.selectionMode},set:function(i){i!=this.selectionMode&&(this._selHdl.selectionMode=n.asEnum(i,t.SelectionMode),this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"selection",{get:function(){return this._selHdl.selection.clone()},set:function(n){this._selHdl.selection=n},enumerable:!0,configurable:!0}),u.prototype.select=function(i,r){typeof r=="undefined"&&(r=!0);n.isInt(i)&&n.isInt(r)&&(i=new t.CellRange(i,r),r=!0);i=n.asType(i,t.CellRange);this._selHdl.select(i,r)},u.prototype.getSelectedState=function(t,i){return this._selHdl.getSelectedState(n.asInt(t),n.asInt(i))},u.prototype.scrollIntoView=function(t,i){var r=this.scrollPosition,h=this._szClient.width,o=this._szClient.height,e=this.cells._getFrozenPos(),u;if(t=n.asInt(t),t>-1&&t<this._rows.length&&t>=this._rows.frozen){var f=this._rows[t],c=f.pos/(this.cells.height-o),l=Math.round(this._maxOffsetY*c),s=f.pos-l;f.pos+f.renderSize>-r.y+o&&(r.y=Math.max(-s,o-(f.pos+f.renderSize)));s-e.y<-r.y&&(r.y=-(s-e.y))}return(i=n.asInt(i),i>-1&&i<this._cols.length&&i>=this._cols.frozen&&(u=this._cols[i],u.pos+u.renderSize>-r.x+h&&(r.x=Math.max(-u.pos,h-(u.pos+u.renderSize))),u.pos-e.x<-r.x&&(r.x=-(u.pos-e.x))),!r.equals(this.scrollPosition))?(this.scrollPosition=r,!0):!1},u.prototype.isRangeValid=function(n){return n.isValid&&n.bottomRow<this.rows.length&&n.rightCol<this.columns.length},u.prototype.startEditing=function(n,t,i){return typeof n=="undefined"&&(n=!0),this._edtHdl.startEditing(n,t,i)},u.prototype.finishEditing=function(n){return typeof n=="undefined"&&(n=!1),this._edtHdl.finishEditing(n)},Object.defineProperty(u.prototype,"activeEditor",{get:function(){return this._edtHdl.activeEditor},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"editRange",{get:function(){return this._edtHdl.editRange},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"mergeManager",{get:function(){return this._mrgMgr},set:function(t){t!=this._mrgMgr&&(this._mrgMgr=n.asType(t,"IMergeManager",!0),this.invalidate())},enumerable:!0,configurable:!0}),u.prototype.getMergedRange=function(n,t,i){return this._mrgMgr?this._mrgMgr.getMergedRange(n,t,i):null},u.prototype.onItemsSourceChanged=function(){this.itemsSourceChanged.raise(this)},u.prototype.onScrollPositionChanged=function(){this.scrollPositionChanged.raise(this)},u.prototype.onSelectionChanging=function(n){return this.selectionChanging.raise(this,n),!n.cancel},u.prototype.onSelectionChanged=function(n){return this.selectionChanged.raise(this,n),!n.cancel},u.prototype.onLoadingRows=function(n){this.loadingRows.raise(this,n)},u.prototype.onLoadedRows=function(n){this.loadedRows.raise(this,n)},u.prototype.onResizingColumn=function(n){return this.resizingColumn.raise(this,n),!n.cancel},u.prototype.onResizedColumn=function(n){this.resizedColumn.raise(this,n)},u.prototype.onDraggingColumn=function(n){return this.draggingColumn.raise(this,n),!n.cancel},u.prototype.onDraggedColumn=function(n){this.draggedColumn.raise(this,n)},u.prototype.onResizingRow=function(n){return this.resizingRow.raise(this,n),!n.cancel},u.prototype.onResizedRow=function(n){this.resizedRow.raise(this,n)},u.prototype.onDraggingRow=function(n){return this.draggingRow.raise(this,n),!n.cancel},u.prototype.onDraggedRow=function(n){this.draggedRow.raise(this,n)},u.prototype.onGroupCollapsedChanging=function(n){return this.groupCollapsedChanging.raise(this,n),!n.cancel},u.prototype.onGroupCollapsedChanged=function(n){this.groupCollapsedChanged.raise(this,n)},u.prototype.onSortingColumn=function(n){return this.sortingColumn.raise(this,n),!n.cancel},u.prototype.onSortedColumn=function(n){this.sortedColumn.raise(this,n)},u.prototype.onBeginningEdit=function(n){return this.beginningEdit.raise(this,n),!n.cancel},u.prototype.onPrepareCellForEdit=function(n){this.prepareCellForEdit.raise(this,n)},u.prototype.onCellEditEnding=function(n){return this.cellEditEnding.raise(this,n),!n.cancel},u.prototype.onCellEditEnded=function(n){this.cellEditEnded.raise(this,n)},u.prototype.onRowEditEnding=function(n){this.rowEditEnding.raise(this,n)},u.prototype.onRowEditEnded=function(n){this.rowEditEnded.raise(this,n)},u.prototype.onRowAdded=function(n){this.rowAdded.raise(this,n)},u.prototype.onDeletingRow=function(n){this.deletingRow.raise(this,n)},u.prototype.onCopying=function(n){return this.copying.raise(this,n),!n.cancel},u.prototype.onCopied=function(n){this.copied.raise(this,n)},u.prototype.onPasting=function(n){return this.pasting.raise(this,n),!n.cancel},u.prototype.onPasted=function(n){this.pasted.raise(this,n)},u.prototype._bindGrid=function(t){var i=this,r;i.deferUpdate(function(){var u,f,e,n;if(i._lastCount==0&&i._cv&&i._cv.items&&i._cv.items.length&&(t=!0),u=[],i.selectionMode==5)for(n=0;n<i.rows.length;n++)f=i.rows[n],f.isSelected&&f.dataItem&&u.push(f.dataItem);if(i.rows.deferUpdate(function(){i._bindRows()}),t&&i.columns.deferUpdate(function(){i._bindColumns()}),e=0,u.length)for(n=0;n<i.rows.length&&e<u.length;n++)u.indexOf(i.rows[n].dataItem)>-1&&(i.rows[n].isSelected=!0,e++);if(i.selectionMode==5&&e==0)for(r=i.selection,n=r.topRow;n<=r.bottomRow&&n>-1;n++)i.rows[n].isSelected=!0;!i._lastCount&&i._cv&&i._cv.items&&(i._lastCount=i._cv.items.length)});i.collectionView&&i._cvCurrentChanged(i.collectionView,n.EventArgs.empty)},u.prototype._cvCollectionChanged=function(i,r){var u;if(this.autoGenerateColumns&&this.columns.length==0)this._bindGrid(!0);else{switch(r.action){case 2:this.invalidate();return;case 0:if(r.index==this.collectionView.items.length-1){u=this.rows.length;this.rows[u-1]instanceof t._NewRowTemplate&&u--;this.rows.insert(u,new t.Row(r.item));return}n.assert(!1,"added item should be the last one.");break;case 1:if(u=this._findRow(r.item),u>-1){this.rows.removeAt(u);this._cvCurrentChanged(i,r);return}n.assert(!1,"removed item not found in grid.")}this._bindGrid(!1)}},u.prototype._cvCurrentChanged=function(){if(this.collectionView){var n=this.selection,t=this._getRowIndex(this.collectionView.currentPosition);n.row!=t&&(n.row=n.row2=t,this.select(n))}},u.prototype._getRowIndex=function(n){var i,n;if(this.collectionView){if(n>-1){for(i=this.collectionView.items[n];n<this.rows.length;n++)if(this.rows[n].dataItem===i)return n;return-1}return n=this.selection.row,n>-1&&this.rows[n]instanceof t.GroupRow?n:-1}return this.selection.row},u.prototype._getCvIndex=function(n){if(n>-1&&this.collectionView){var t=this.rows[n].dataItem;for(n=Math.min(n,this.collectionView.items.length);n>-1;n--)if(this.collectionView.items[n]===t)return n}return-1},u.prototype._findRow=function(n){for(var t=0;t<this.rows.length;t++)if(this.rows[t].dataItem==n)return t;return-1},u.prototype._createChildren=function(){var n=this.getTemplate();this.applyTemplate("wj-control wj-flexgrid wj-content",n,{_root:"root",_eSz:"sz",_eCt:"cells",_eTL:"tl",_eCHdr:"ch",_eRHdr:"rh",_eTLCt:"tlcells",_eCHdrCt:"chcells",_eRHdrCt:"rhcells"});this._gpCells=new t.GridPanel(this,1,this._rows,this._cols,this._eCt);this._gpCHdr=new t.GridPanel(this,2,this._hdrRows,this._cols,this._eCHdrCt);this._gpRHdr=new t.GridPanel(this,3,this._rows,this._hdrCols,this._eRHdrCt);this._gpTL=new t.GridPanel(this,4,this._hdrRows,this._hdrCols,this._eTLCt)},u.prototype._updateLayout=function(){var e=this._rows.getTotalSize(),t=this._hdrVis&2?this._hdrCols.getTotalSize():0,i=this._hdrVis&1?this._hdrRows.getTotalSize():0,f,r;this._rtl=getComputedStyle(this.hostElement).direction=="rtl";this._heightBrowser=Math.min(e,u._getMaxSupportedCssHeight());this._maxOffsetY=Math.max(0,e-this._heightBrowser);this._rtl?(n.setCss(this._eTL,{right:0,top:0,width:t,height:i}),n.setCss(this._eCHdr,{top:0,right:t,height:i}),n.setCss(this._eRHdr,{right:0,top:i,width:t}),n.setCss(this._eCt,{right:t,top:i,width:this._gpCells.width,height:this._heightBrowser})):(n.setCss(this._eTL,{left:0,top:0,width:t,height:i}),n.setCss(this._eCHdr,{top:0,left:t,height:i}),n.setCss(this._eRHdr,{left:0,top:i,width:t}),n.setCss(this._eCt,{left:t,top:i,width:this._gpCells.width,height:this._heightBrowser}));f=this._eSz.style;f.width=t+this._gpCells.width+"px";f.height=i+this._heightBrowser+"px";r=null;this.columns._updateStarSizes(this._root.clientWidth-t)&&(r=this._root.clientWidth,this._eCt.style.width=this._gpCells.width+"px");this._szClient=new n.Size(this._root.clientWidth-t,this._root.clientHeight-i);this._rcBounds=null;this._updateContent(!1);this._szClient=new n.Size(this._root.clientWidth-t,this._root.clientHeight-i);r&&r!=this._root.clientWidth&&this.columns._updateStarSizes(this._root.clientWidth-t)&&(this._eCt.style.width=this._gpCells.width+"px",this._updateContent(!1));this._eCHdr.style.width=this._szClient.width+"px";this._eRHdr.style.height=this._szClient.height+"px"},u.prototype._updateContent=function(n,t){var i=1;this._heightBrowser>this._szClient.height&&(i=-this._ptScrl.y/(this._heightBrowser-this._szClient.height));this._offsetY=Math.round(this._maxOffsetY*i);t?this._gpCells._updateContent(n,this._offsetY,t):(this._gpCells._updateContent(n,this._offsetY),this._gpCHdr._updateContent(n,0),this._gpRHdr._updateContent(n,this._offsetY),this._gpTL._updateContent(n,0));this._rcBounds=null},u.prototype._bindColumns=function(){for(var i,r,f,e,o,u=0;u<this.columns.length;u++)i=this.columns[u],i._getFlag(32)&&(this.columns.removeAt(u),u--);if(r=null,f=this.collectionView,f&&f.sourceCollection&&f.sourceCollection.length&&(r=f.sourceCollection[0]),r&&this.autoGenerateColumns)for(e in r)n.isPrimitive(r[e])&&(i=new t.Column,i._setFlag(32,!0),i.binding=i.name=e,i.dataType=n.getType(r[e]),o=Object.getOwnPropertyDescriptor(r,e),o&&!o.writable&&i._setFlag(512,!0),i.dataType==2&&(i.width=80),this.columns.push(i));r&&this._updateColumnTypes()},u.prototype._updateColumnTypes=function(){var i=this.collectionView,u,t,r;if(i&&i.items&&i.items.length)for(u=i.items[0],r=0;r<this.columns.length;r++)t=this.columns[r],t.dataType==null&&t.binding&&(t.dataType=n.getType(u[t.binding]))},u.prototype._bindRows=function(){var f=new n.CancelEventArgs,r,u,i,e;this.onLoadingRows(f);if(!f.cancel){if(this.rows.clear(),this.collectionView&&this.collectionView.items)if(r=this.collectionView.items,u=this.collectionView.groups,this.childItemsPath)for(i=0;i<r.length;i++)this._addTreeNode(r[i],0);else if(u!=null&&u.length>0&&this.showGroups)for(i=0;i<u.length;i++)this._addGroup(u[i]);else for(i=0;i<r.length;i++)e=new t.Row(r[i]),this.rows.push(e);this.onLoadedRows(f)}},u.prototype._addGroup=function(n){var r=new t.GroupRow,u,i;if(r.level=n.level,r.dataItem=n,this.rows.push(r),n.isBottomLevel)for(i=0;i<n.items.length;i++)u=new t.Row(n.items[i]),this.rows.push(u);else for(i=0;i<n.groups.length;i++)this._addGroup(n.groups[i])},u.prototype._addTreeNode=function(n,i){var u=new t.GroupRow,f=n[this.childItemsPath],r;if(u.dataItem=n,u.level=i,this.rows.push(u),f)for(r=0;r<f.length;r++)this._addTreeNode(f[r],i+1)},u._getMaxSupportedCssHeight=function(){var t;if(!u._maxCssHeight){var r=1e6,i=n.createElement('<span style="visibility:hidden">');for(document.body.appendChild(i),t=r;t<=6e9;t+=5e5){if(i.style.height=t+"px",parseFloat(i.style.height)!=t)break;r=t}document.body.removeChild(i);u._maxCssHeight=r}return u._maxCssHeight},u._getSerializableProperties=function(n){var f=[],u,t,i,r;for(n=n.prototype;n!==null;n=n.__proto__)for(u=Object.getOwnPropertyNames(n),t=0;t<u.length;t++)i=u[t],r=Object.getOwnPropertyDescriptor(n,i),r&&r.set&&r.get&&i[0]!="_"&&f.push(i);return f},u.prototype._copy=function(i,r){var f,u,e;if(i=="columns"){for(f=n.asArray(r),u=0;u<f.length;u++)e=new t.Column,n.copy(e,f[u]),this.columns.push(e);return!0}return!1},u.prototype._hasAttribute=function(n,t){for(;n;n=n.parentNode)if(n.getAttribute&&n.getAttribute(t)!=null)return!0;return!1},u.controlTemplate='<div style="position:relative;width:100%;height:100%;max-height:inherit;overflow:hidden"><div wj-part="root" style="position:absolute;width:100%;height:100%;max-height:inherit;overflow:auto;-webkit-overflow-scrolling:touch"><div wj-part="cells" style ="position:relative"><\/div><\/div><div wj-part="tl" style="position:absolute;overflow:hidden;z-index:100"><div wj-part="tlcells" class="wj-topleft" style="position:relative"><\/div><\/div><div wj-part="ch" style="position:absolute;overflow:hidden;z-index:100"><div wj-part="chcells" class="wj-colheaders" style="position:relative"><\/div><\/div><div wj-part="rh" style="position:absolute;overflow:hidden;z-index:100"><div wj-part="rhcells" class="wj-rowheaders" style="position:relative"><\/div><\/div><div wj-part="sz" style="position:relative;visibility:hidden;"><\/div><\/div>',u}(n.Control);t.FlexGrid=r})(n.grid||(n.grid={}));var t=n.grid}(wijmo||(wijmo={}));__extends=this.__extends||function(n,t){function r(){this.constructor=n}for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);r.prototype=t.prototype;n.prototype=new r},function(n){(function(t){"use strict";var i=function(i){function r(r,u){i.call(this);this._panel=n.asType(r,t.GridPanel);this._rng=n.asType(u,t.CellRange)}return __extends(r,i),Object.defineProperty(r.prototype,"panel",{get:function(){return this._panel},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"cellRange",{get:function(){return this._rng.clone()},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"row",{get:function(){return this._rng.row},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"col",{get:function(){return this._rng.col},enumerable:!0,configurable:!0}),r}(n.CancelEventArgs);t.CellRangeEventArgs=i})(n.grid||(n.grid={}));var t=n.grid}(wijmo||(wijmo={})),function(n){(function(t){"use strict";(function(n){n[n.None=0]="None";n[n.Cell=1]="Cell";n[n.ColumnHeader=2]="ColumnHeader";n[n.RowHeader=3]="RowHeader";n[n.TopLeft=4]="TopLeft"})(t.CellType||(t.CellType={}));var r=t.CellType,i=function(){function i(i,r,u,f,e){this._offsetY=0;this._g=n.asType(i,t.FlexGrid);this._ct=n.asInt(r);this._rows=n.asType(u,t.RowCollection);this._cols=n.asType(f,t.ColumnCollection);this._e=n.asType(e,HTMLElement);this._rng=new t.CellRange}return Object.defineProperty(i.prototype,"grid",{get:function(){return this._g},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"cellType",{get:function(){return this._ct},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"viewRange",{get:function(){return this._getViewRange(!1)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"width",{get:function(){return this._cols.getTotalSize()},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"height",{get:function(){return this._rows.getTotalSize()},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"rows",{get:function(){return this._rows},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"columns",{get:function(){return this._cols},enumerable:!0,configurable:!0}),i.prototype.getCellData=function(i,r,u){var f=this._cols[r],o=this._rows[i],e=null,s;if(o.dataItem&&f.binding?e=f._binding.getValue(o.dataItem):o._ubv&&(e=o._ubv[f._hash]),e==null)switch(this._ct){case 2:i==this._rows.length-1&&f.header&&(e=f.header);break;case 1:f.aggregate!=0&&o instanceof t.GroupRow&&(s=n.tryCast(o.dataItem,n.collections.CollectionViewGroup),s&&(e=s.getAggregate(f.aggregate,f.binding)))}return u&&(e=this.cellType==1&&f.dataMap?f.dataMap.getDisplayValue(e):n.Globalize.format(e,f.format),e==null&&(e="")),e},i.prototype.setCellData=function(t,i,r,u){var e,f,o,s;if(typeof u=="undefined"&&(u=!0),e=this._rows[n.asNumber(t,!1,!0)],n.isString(i)&&(i=this._cols.indexOf(i),i<0))throw"Invalid column name or binding.";if(f=this._cols[n.asNumber(i,!1,!0)],this._ct==1){if(f.dataMap&&r!=null&&(r=f.dataMap.getKeyValue(r),r==null))return!1;if(o=0,f.dataType?o=f.dataType:(s=this.getCellData(t,i,!1),o=n.getType(s)),n.isBoolean(f.required))if(f.required||r!==""&&r!==null){if(f.required&&(r===""||r===null))return!1}else r=null,u=!1;if(u&&(r=n.changeType(r,o,f.format),o!=0&&n.getType(r)!=o))return!1}return e.dataItem&&f.binding?f._binding.setValue(e.dataItem,r):(e._ubv||(e._ubv={}),e._ubv[f._hash]=r),!0},Object.defineProperty(i.prototype,"hostElement",{get:function(){return this._e},enumerable:!0,configurable:!0}),i.prototype._getOffsetY=function(){return this._offsetY},i.prototype._updateContent=function(t,i,r){var u,e,l,o=this._g,h=this._e.style,v=this._rows,y=this._cols,c=o.scrollPosition,p=o.containsFocus(),w=n.isTouchDevice(),f,a,s;if((this._ct==2||this._ct==3)&&(this.cellType==2?o._rtl?h.right=c.x+"px":h.left=c.x+"px":this.cellType==3&&(h.top=c.y+"px")),this._offsetY!=i&&(t=!1,this._offsetY=i),f=this._getViewRange(w&&!o._isIE),!t||r||!this._rng.contains(f)||v.frozen||y.frozen){for(t||(this._e.textContent="",r=null),f.equals(this._rng)||(r=null),this._rng=f,e=0,u=0;u<this.rows.frozen&&u<this.rows.length;u++)e=this._renderRow(u,f,r,e);for(u=f.topRow;u<=f.bottomRow&&u>-1;u++)e=this._renderRow(u,f,r,e);for(a=this._e.childElementCount,s=e;s<a;s++)l=this._e.childNodes[s],l.style.display="none";p&&!o.containsFocus()&&o.focus()}},i.prototype._renderRow=function(n,t,i,r){var u;if(this.rows[n].renderSize<=0)return r;for(u=0;u<this.columns.frozen&&u<this.columns.length;u++)r=this._renderCell(n,u,t,i,r);for(u=t.leftCol;u<=t.rightCol&&u>-1;u++)r=this._renderCell(n,u,t,i,r);return r},i.prototype._renderCell=function(i,r,u,f,e){var s,o,c,h,l,a;if(this.columns[r].renderSize<=0||(s=this._g.getMergedRange(this,i,r),s&&(i>u.topRow&&s.row<i||r>u.leftCol&&s.col<r)))return e;if(o=this._e.childNodes[e++],f){for(c=!1,h=0;h<f.length&&!c;h++)c=s?f[h].intersects(s):f[h].contains(i,r);if(!c)return e;if(o)return l=this._g.getSelectedState(i,r),a=this.rows[i]instanceof t.GroupRow,n.toggleClass(o,"wj-state-selected",l==2),n.toggleClass(o,"wj-state-multi-selected",l==1),n.toggleClass(o,"wj-group",l==0&&a),e}return o?o.style.display="":(o=document.createElement("div"),this._e.appendChild(o)),this._g.cellFactory.updateCell(this,i,r,o,s),e},i.prototype._getViewRange=function(n){var l=this._g,a=l.scrollPosition,i=this._rows,r=this._cols,f=new t.CellRange(0,0,i.length-1,r.length-1),u;if(this._ct==1||this._ct==3){var e=-a.y+this._offsetY,o=l.clientSize.height+1,s=Math.min(i.frozen,i.length-1);s>0&&(u=i[s-1].pos,e+=u,o-=u,n=!1);n&&(e-=o,o*=3);f.row=Math.min(i.length-1,Math.max(i.frozen,i.getItemAt(e)));f.row2=i.getItemAt(e+o)}if(this._ct==1||this._ct==2){var h=-a.x,c=l.clientSize.width+1,s=Math.min(r.frozen,r.length-1);s>0&&(u=r[s-1].pos,h+=u,c-=u,n=!1);n&&(h-=c,c*=3);f.col=Math.min(r.length-1,Math.max(r.frozen,r.getItemAt(h)));f.col2=r.getItemAt(h+c)}return f},i.prototype._getFrozenPos=function(){var r=this._rows.frozen,u=this._cols.frozen,t=r>0?this._rows[r-1]:null,i=u>0?this._cols[u-1]:null,f=t?t.pos+t.renderSize:0,e=i?i.pos+i.renderSize:0;return new n.Point(e,f)},i}();t.GridPanel=i})(n.grid||(n.grid={}));var t=n.grid}(wijmo||(wijmo={})),function(n){(function(t){"use strict";var i=function(){function i(){}return i.prototype.updateCell=function(r,u,f,e,o){var s=r.grid,y=r.cellType,c=e.style,b=r.rows,k=r.columns,v=b[u],h=k[f],w=n.tryCast(v,t.GroupRow),l=r.getCellData(u,f,!0),ot=h.renderWidth,st=v.renderHeight,a="wj-cell",nt,g,tt,it,rt,ut,p,ft,d,at,et;if(o&&(u=o.row,f=o.col,v=b[u],h=k[f],w=n.tryCast(v,t.GroupRow),l=r.getCellData(u,f,!0),nt=o.getRenderSize(r),st=nt.height,ot=nt.width),g=h.pos,tt=v.pos,u<b.frozen&&(tt-=s.scrollPosition.y),f<k.frozen&&(g-=s.scrollPosition.x),s._rtl?c.right=g+"px":c.left=g+"px",c.top=tt-r._getOffsetY()+"px",c.width=ot+"px",c.height=st+"px",y==1){it=r.grid.getSelectedState(u,f);s.editRange&&s.editRange.contains(u,f)&&h.dataType!=3&&(it=0);switch(it){case 2:a+=" wj-state-selected";break;case 1:a+=" wj-state-multi-selected";break;case 0:w?a+=" wj-group":u%2!=0&&(a+=" wj-alt")}(u<b.frozen||f<k.frozen)&&(a+=" wj-frozen");n.tryCast(v,t._NewRowTemplate)&&(a+=" wj-new");v.cssClass&&(a+=" "+v.cssClass);h.cssClass&&(a+=" "+h.cssClass)}else a+=" wj-header";if((h.wordWrap||v.wordWrap)&&(a+=" wj-wrap"),c.zIndex=u<b.frozen&&f<k.frozen?"2":u<b.frozen||f<k.frozen?"1":"",u==b.frozen-1&&(a+=" wj-frozen-row"),f==k.frozen-1&&(a+=" wj-frozen-col"),e.className=a,c.textAlign=h.getAlignment(),y==1&&(c.paddingLeft=c.paddingRight="",s.rows.maxGroupLevel>-1&&f==s.columns.firstVisibleIndex)){var ct=w?Math.max(0,w.level):s.rows.maxGroupLevel+1,lt=parseInt(getComputedStyle(e).paddingLeft),ht=s.treeIndent*ct+lt+"px";s._rtl?c.paddingRight=ht:c.paddingLeft=ht}y==1&&f==s.columns.firstVisibleIndex&&w&&w.hasChildren&&!this._isEditingCell(s,u,f)?(l||(l=this._getGroupHeader(w)),e.innerHTML=this._getTreeIcon(w)+" "+l,c.textAlign=""):y==2&&u==s.columnHeaders.rows.length-1&&h.currentSort&&s.showSort?e.innerHTML=n.escapeHtml(l)+"&nbsp;"+this._getSortIcon(h):y!=3||f!=s.rowHeaders.columns.length-1||l?y==1&&h.dataType==3?(p=e.children?n.tryCast(e.children[0],HTMLInputElement):null,p&&p.type=="checkbox"||(e.innerHTML='<input type="checkbox"/>',p=n.tryCast(e.children[0],HTMLInputElement)),p.checked=l==!0?!0:!1,p.indeterminate=r.getCellData(u,f,!1)==null,p.disabled=!s._edtHdl._allowEditing(u,f),p.disabled&&(p.style.cursor="default"),s.editRange&&s.editRange.contains(u,f)&&(s._edtHdl._edt=p)):y==1&&this._isEditingCell(s,u,f)?(ft=h.inputType,h.inputType||(ft=h.dataType==2&&!h.dataMap?"tel":"text"),e.innerHTML='<input type="'+ft+'" class="wj-grid-editor wj-form-control">',d=e.children[0],d.value=l,d.style.textAlign=c.textAlign,c.padding="0px",h.mask&&(at=new n._MaskProvider(d,h.mask)),s._edtHdl._edt=d):y==1&&(v.isContentHtml||h.isContentHtml)?e.innerHTML=l:e.textContent=l:(rt=s.collectionView,ut=rt?rt.currentEditItem:null,ut&&v.dataItem==ut?l="âœŽ":n.tryCast(v,t._NewRowTemplate)&&(l="*"),e.textContent=l);switch(y){case 3:e.draggable=(s.allowDragging&2)!=0;break;case 2:e.draggable=(s.allowDragging&1)!=0}y==1&&n.input&&h.dataMap&&h.showDropDown!==!1&&s._edtHdl._allowEditing(u,f)&&(et=n.createElement("<div "+i._WJA_DROPDOWN+'><span class="wj-glyph-down"><\/span><\/div>'),n.setCss(et,{position:"absolute",right:0,top:0,padding:3,opacity:.25}),e.appendChild(et));s.itemFormatter&&s.itemFormatter(r,u,f,e)},i.prototype._isEditingCell=function(n,t,i){return n.editRange&&n.editRange.contains(t,i)},i.prototype._getGroupHeader=function(t){var u=t.grid,o=u.groupHeaderFormat?u.groupHeaderFormat:n.culture.FlexGrid.groupHeaderFormat,r=n.tryCast(t.dataItem,n.collections.CollectionViewGroup);if(r&&o){var f=r.groupDescription.propertyName,e=r.name,i=u.columns.getColumn(f);return i&&i.header&&(f=i.header),i&&i.dataMap&&(e=i.dataMap.getDisplayValue(e)),n.format(o,{name:n.escapeHtml(f),value:n.escapeHtml(e),level:r.level,count:r.items.length})}return""},i.prototype._getTreeIcon=function(n){var t="wj-glyph-";return t+=n.grid._rtl?n.isCollapsed?"left":"down-left":n.isCollapsed?"right":"down-right","<span "+i._WJA_COLLAPSE+' class="'+t+'"><\/span>&nbsp;'},i.prototype._getSortIcon=function(n){return'<span class="wj-glyph-'+(n.currentSort=="+"?"up":"down")+'"><\/span>'},i._WJA_COLLAPSE="wj-collapse",i._WJA_DROPDOWN="wj-dropdown",i}();t.CellFactory=i})(n.grid||(n.grid={}));var t=n.grid}(wijmo||(wijmo={})),function(n){(function(t){"use strict";var i=function(){function t(t,i,r,u){typeof t=="undefined"&&(t=-1);typeof i=="undefined"&&(i=-1);typeof r=="undefined"&&(r=t);typeof u=="undefined"&&(u=i);this._row=n.asInt(t);this._col=n.asInt(i);this._row2=n.asInt(r);this._col2=n.asInt(u)}return Object.defineProperty(t.prototype,"row",{get:function(){return this._row},set:function(t){this._row=n.asInt(t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"col",{get:function(){return this._col},set:function(t){this._col=n.asInt(t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"row2",{get:function(){return this._row2},set:function(t){this._row2=n.asInt(t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"col2",{get:function(){return this._col2},set:function(t){this._col2=n.asInt(t)},enumerable:!0,configurable:!0}),t.prototype.clone=function(){return new t(this._row,this._col,this._row2,this._col2)},Object.defineProperty(t.prototype,"rowSpan",{get:function(){return Math.abs(this._row2-this._row)+1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"columnSpan",{get:function(){return Math.abs(this._col2-this._col)+1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"topRow",{get:function(){return Math.min(this._row,this._row2)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bottomRow",{get:function(){return Math.max(this._row,this._row2)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"leftCol",{get:function(){return Math.min(this._col,this._col2)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rightCol",{get:function(){return Math.max(this._col,this._col2)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isValid",{get:function(){return this._row>-1&&this._col>-1&&this._row2>-1&&this._col2>-1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isSingleCell",{get:function(){return this._row==this._row2&&this._col==this._col2},enumerable:!0,configurable:!0}),t.prototype.contains=function(i,r){var u=n.tryCast(i,t);if(u)return u.topRow>=this.topRow&&u.bottomRow<=this.bottomRow&&u.leftCol>=this.leftCol&&u.rightCol<=this.rightCol;if(n.isInt(i)&&n.isInt(r))return i>=this.topRow&&i<=this.bottomRow&&r>=this.leftCol&&r<=this.rightCol;throw"contains expects a CellRange or row/column indices.";},t.prototype.containsRow=function(t){return n.asInt(t),t>=this.topRow&&t<=this.bottomRow},t.prototype.containsColumn=function(t){return n.asInt(t),t>=this.leftCol&&t<=this.rightCol},t.prototype.intersects=function(n){return this.rightCol<n.leftCol||this.leftCol>n.rightCol||this.bottomRow<n.topRow||this.topRow>n.bottomRow?!1:!0},t.prototype.getRenderSize=function(t){for(var i,r=new n.Size(0,0),u=this.topRow;u<=this.bottomRow;u++)r.height+=t.rows[u].renderSize;for(i=this.leftCol;i<=this.rightCol;i++)r.width+=t.columns[i].renderSize;return r},t.prototype.equals=function(n){return n instanceof t&&this._row==n._row&&this._col==n._col&&this._row2==n._row2&&this._col2==n._col2},t}();t.CellRange=i})(n.grid||(n.grid={}));var t=n.grid}(wijmo||(wijmo={}));__extends=this.__extends||function(n,t){function r(){this.constructor=n}for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);r.prototype=t.prototype;n.prototype=new r},function(n){(function(t){"use strict";var f,i,r,e,o,u,s,h;(function(n){n[n.Visible=1]="Visible";n[n.AllowResizing=2]="AllowResizing";n[n.AllowDragging=4]="AllowDragging";n[n.AllowMerging=8]="AllowMerging";n[n.AllowSorting=16]="AllowSorting";n[n.AutoGenerated=32]="AutoGenerated";n[n.Collapsed=64]="Collapsed";n[n.ParentCollapsed=128]="ParentCollapsed";n[n.Selected=256]="Selected";n[n.ReadOnly=512]="ReadOnly";n[n.HtmlContent=1024]="HtmlContent";n[n.WordWrap=2048]="WordWrap";n[n.RowDefault=n.Visible|n.AllowResizing]="RowDefault";n[n.ColumnDefault=n.Visible|n.AllowDragging|n.AllowResizing|n.AllowSorting]="ColumnDefault"})(t.RowColFlags||(t.RowColFlags={}));f=t.RowColFlags;i=function(){function t(){this._list=null;this._pos=0;this._idx=-1}return Object.defineProperty(t.prototype,"visible",{get:function(){return this._getFlag(1)},set:function(n){this._setFlag(1,n)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isVisible",{get:function(){return this._getFlag(1)&&!this._getFlag(128)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"pos",{get:function(){return this._list&&this._list._update(),this._pos},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"index",{get:function(){return this._list&&this._list._update(),this._idx},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this._sz},set:function(t){t!=this._sz&&(this._sz=n.asNumber(t,!0),this.onPropertyChanged())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"renderSize",{get:function(){if(!this.isVisible)return 0;var n=this._sz,t=this._list;return(n==null||n<0)&&t!=null?Math.round(t.defaultSize):(t!=null&&(t.minSize!=null&&n<t.minSize&&(n=t.minSize),t.maxSize!=null&&n>t.maxSize&&(n=t.maxSize)),this._szMin!=null&&n<this._szMin&&(n=this._szMin),this._szMax!=null&&n>this._szMax&&(n=this._szMax),Math.round(n))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"allowResizing",{get:function(){return this._getFlag(2)},set:function(n){this._setFlag(2,n)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"allowDragging",{get:function(){return this._getFlag(4)},set:function(n){this._setFlag(4,n)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"allowMerging",{get:function(){return this._getFlag(8)},set:function(n){this._setFlag(8,n)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isSelected",{get:function(){return this._getFlag(256)},set:function(n){this._setFlag(256,n)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isReadOnly",{get:function(){return this._getFlag(512)},set:function(n){this._setFlag(512,n)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isContentHtml",{get:function(){return this._getFlag(1024)},set:function(n){this.isContentHtml!=n&&(this._setFlag(1024,n),this.grid&&this.grid.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"wordWrap",{get:function(){return this._getFlag(2048)},set:function(n){this._setFlag(2048,n)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"cssClass",{get:function(){return this._cssClass},set:function(t){t!=this._cssClass&&(this._cssClass=n.asString(t),this.grid&&this.grid.invalidate(!1))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"grid",{get:function(){return this._list?this._list._g:null},enumerable:!0,configurable:!0}),t.prototype.onPropertyChanged=function(){this._list&&(this._list._dirty=!0,this.grid.invalidate())},t.prototype._getFlag=function(n){return(this._f&n)!=0},t.prototype._setFlag=function(n,t){return t!=this._getFlag(n)?(this._f=t?this._f|n:this._f&~n,this.onPropertyChanged(),!0):!1},t}();t.RowCol=i;r=function(i){function r(t){i.call(this);this._f=f.ColumnDefault;this._hash=r._ctr.toString(36);r._ctr++;t&&n.copy(this,t)}return __extends(r,i),Object.defineProperty(r.prototype,"name",{get:function(){return this._name},set:function(n){this._name=n},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"dataType",{get:function(){return this._type},set:function(t){this._type!=t&&(this._type=n.asEnum(t,n.DataType),this.grid&&this.grid.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"required",{get:function(){return this._required},set:function(t){this._required=n.asBoolean(t,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"showDropDown",{get:function(){return this._showDropDown},set:function(t){t!=this._showDropDown&&(this._showDropDown=n.asBoolean(t,!0),this.grid&&this.grid.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"inputType",{get:function(){return this._inpType},set:function(t){this._inpType=n.asString(t,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"mask",{get:function(){return this._mask},set:function(t){this._mask=n.asString(t,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"binding",{get:function(){return this._binding?this._binding.path:null},set:function(t){var r,i,u;t!=this.binding&&(r=n.asString(t),this._binding=r?new n._Binding(r):null,!this._type&&this.grid&&this._binding&&(i=this.grid.collectionView,i&&i.sourceCollection&&i.sourceCollection.length&&(u=i.sourceCollection[0],this._type=n.getType(this._binding.getValue(u)))),this.onPropertyChanged())},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"width",{get:function(){return this._szStar!=null?this._szStar:this.size},set:function(t){r._parseStarSize(t)!=null?(this._szStar=t,this.onPropertyChanged()):(this._szStar=null,this.size=n.asNumber(t,!0))},enumerable:!0,configurable:!0}),r._parseStarSize=function(t){if(n.isString(t)&&t.length>0&&t[t.length-1]=="*"){var i=t.length==1?1:t.substr(0,t.length-1)*1;if(i>0&&!isNaN(i))return i}return null},Object.defineProperty(r.prototype,"minWidth",{get:function(){return this._szMin},set:function(t){t!=this._szMin&&(this._szMin=n.asNumber(t,!0,!0),this.onPropertyChanged())},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"maxWidth",{get:function(){return this._szMax},set:function(t){t!=this._szMax&&(this._szMax=n.asNumber(t,!0,!0),this.onPropertyChanged())},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"renderWidth",{get:function(){return this.renderSize},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"align",{get:function(){return this._align},set:function(n){this._align!=n&&(this._align=n,this.onPropertyChanged())},enumerable:!0,configurable:!0}),r.prototype.getAlignment=function(){var n=this._align;if(n==null&&(n="",!this._map))switch(this._type){case 3:n="center";break;case 2:n="right"}return n},Object.defineProperty(r.prototype,"header",{get:function(){return this._hdr?this._hdr:this.binding},set:function(n){this._hdr!=n&&(this._hdr=n,this.onPropertyChanged())},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"dataMap",{get:function(){return this._map},set:function(i){this._map!=i&&(this._map&&this._map.mapChanged.removeHandler(this.onPropertyChanged,this),n.isArray(i)&&(i=new t.DataMap(i,null,null)),this._map=n.asType(i,t.DataMap,!0),this._map&&this._map.mapChanged.addHandler(this.onPropertyChanged,this),this.onPropertyChanged())},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"format",{get:function(){return this._fmt},set:function(n){this._fmt!=n&&(this._fmt=n,this.onPropertyChanged())},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"allowSorting",{get:function(){return this._getFlag(16)},set:function(n){this._setFlag(16,n)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"currentSort",{get:function(){var t,n;if(this.grid&&this.grid.collectionView&&this.grid.collectionView.canSort)for(t=this.grid.collectionView.sortDescriptions,n=0;n<t.length;n++)if(t[n].property==this.binding)return t[n].ascending?"+":"-";return null},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"aggregate",{get:function(){return this._agg!=null?this._agg:0},set:function(t){t!=this._agg&&(this._agg=n.asEnum(t,n.Aggregate),this.onPropertyChanged())},enumerable:!0,configurable:!0}),r._ctr=0,r}(i);t.Column=r;e=function(n){function t(t){n.call(this);this._f=f.ColumnDefault;this._data=t}return __extends(t,n),Object.defineProperty(t.prototype,"dataItem",{get:function(){return this._data},set:function(n){this._data=n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.size},set:function(n){this.size=n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"renderHeight",{get:function(){return this.renderSize},enumerable:!0,configurable:!0}),t}(i);t.Row=e;o=function(t){function i(){t.call(this);this._level=-1;this.isReadOnly=!0}return __extends(i,t),Object.defineProperty(i.prototype,"level",{get:function(){return this._level},set:function(t){n.asInt(t);t!=this._level&&(this._level=t,this.onPropertyChanged())},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"hasChildren",{get:function(){var t=null,i=null;return this.grid!=null&&this._list!=null?(this._list._update(),this.index<this._list.length-1&&(t=this._list[this.index+1]),i=n.tryCast(t,n.grid.GroupRow),t&&(i==null||i.level>this.level)):!0},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"isCollapsed",{get:function(){return this._getFlag(64)},set:function(t){n.asBoolean(t);t!=this.isCollapsed&&this._list!=null&&this._setCollapsed(t)},enumerable:!0,configurable:!0}),i.prototype._setCollapsed=function(t){var o=this,i=this.grid,u=i.rows,e=this.getCellRange(),f=new n.grid.CellRangeEventArgs(i.cells,new n.grid.CellRange(this.index,-1)),r;i.onGroupCollapsedChanging(f);if(!f.cancel){i.deferUpdate(function(){o._setFlag(64,t);for(var i=e.topRow+1;i<=e.bottomRow&&i>-1&&i<u.length;i++)u[i]._setFlag(128,t),r=n.tryCast(u[i],n.grid.GroupRow),r!=null&&r.isCollapsed&&(i=r.getCellRange().bottomRow)});i.onGroupCollapsedChanged(f)}},i.prototype.getCellRange=function(){for(var r,u=this._list,f=this.index,i=u.length-1,t=f+1;t<=i;t++)if(r=n.tryCast(u[t],n.grid.GroupRow),r!=null&&r.level<=this.level){i=t-1;break}return new n.grid.CellRange(f,0,i,this.grid.columns.length-1)},i}(e);t.GroupRow=o;u=function(t){function i(i,r){t.call(this);this._frozen=0;this._szDef=25;this._szTot=0;this._dirty=!1;this._g=n.asType(i,n.grid.FlexGrid);this._szDef=n.asNumber(r,!1,!0)}return __extends(i,t),Object.defineProperty(i.prototype,"defaultSize",{get:function(){return this._szDef},set:function(t){this._szDef!=t&&(this._szDef=n.asNumber(t,!1,!0),this._dirty=!0,this._g.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"frozen",{get:function(){return this._frozen},set:function(t){t!=this._frozen&&(this._frozen=n.asNumber(t,!1,!0),this._dirty=!0,this._g.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"minSize",{get:function(){return this._szMin},set:function(t){t!=this._szMin&&(this._szMin=n.asNumber(t,!0,!0),this._dirty=!0,this._g.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"maxSize",{get:function(){return this._szMax},set:function(t){t!=this._szMax&&(this._szMax=n.asNumber(t,!0,!0),this._dirty=!0,this._g.invalidate())},enumerable:!0,configurable:!0}),i.prototype.getTotalSize=function(){return this._update(),this._szTot},i.prototype.getItemAt=function(n){if(this._update(),n<=0&&this.length>0)return 0;for(var u=0,i=this.length-1,t,r;u<=i;)if(t=u+i>>>1,r=this[t],r._pos>n)i=t-1;else if(r._pos+r.renderSize<n)u=t+1;else return t;return i},i.prototype.getNextCell=function(n,t,i){var r,u;switch(t){case 1:for(r=n+1;r<this.length;r++)if(this[r].renderSize>0)return r;break;case 2:for(r=n-1;r>=0;r--)if(this[r].renderSize>0)return r;break;case 6:for(r=this.length-1;r>=0;r--)if(this[r].renderSize>0)return r;break;case 5:for(r=0;r<this.length;r++)if(this[r].renderSize>0)return r;break;case 3:return u=this.getItemAt(this[n].pos+i),u<0?this.getNextCell(n,6,i):u;case 4:return u=this.getItemAt(this[n].pos-i),u<0?this.getNextCell(n,5,i):u}return n},i.prototype.canMoveElement=function(n,t){var r,u,i;if(t==n||n<0||n>=this.length||t>=this.length)return!1;for(t<0&&(t=this.length-1),r=Math.min(n,t),u=Math.max(n,t),i=r;i<=u;i++)if(!this[i].allowDragging)return!1;return!0},i.prototype.moveElement=function(n,t){if(this.canMoveElement(n,t)){var i=this[n];this.removeAt(n);t<0&&(t=this.length);this.insert(t,i)}},i.prototype.onCollectionChanged=function(i){typeof i=="undefined"&&(i=n.collections.NotifyCollectionChangedEventArgs.reset);i.action==0&&(i.item._list=this);this._dirty=!0;this._g.invalidate();t.prototype.onCollectionChanged.call(this,i)},i.prototype.clear=function(){for(var n=0;n<this.length;n++)this[n]._list=null;t.prototype.clear.call(this)},i.prototype._update=function(){var i,n,t;if(this._dirty&&!this._g.isUpdating){for(this._dirty=!1,i=0,t=0;t<this.length;t++)n=this[t],n._idx=t,n._list=this,n._pos=i,i+=n.renderSize;return this._szTot=i,!0}return!1},i}(n.collections.ObservableArray);t.RowColCollection=u;s=function(n){function t(){n.apply(this,arguments);this._firstVisible=-1}return __extends(t,n),t.prototype.getColumn=function(n){var t=this.indexOf(n);return t>-1?this[t]:null},t.prototype.indexOf=function(n){for(var t=0;t<this.length;t++)if(this[t].name==n)return t;for(t=0;t<this.length;t++)if(this[t].binding==n)return t;return-1},Object.defineProperty(t.prototype,"firstVisibleIndex",{get:function(){return this._update(),this._firstVisible},enumerable:!0,configurable:!0}),t.prototype._update=function(){if(n.prototype._update.call(this)){this._firstVisible=-1;for(var t=0;t<this.length;t++)if(this[t].visible){this._firstVisible=t;break}return!0}return!1},t.prototype._updateStarSizes=function(n){for(var e=0,t,u,f,i=0;i<this.length;i++)t=this[i],t.isVisible&&(t._szStar?(e+=r._parseStarSize(t._szStar),u=t):n-=t.renderWidth);if(u!=null){for(f=n,i=0;i<this.length;i++)t=this[i],t.isVisible&&t._szStar&&(t==u?t._sz=f:(t._sz=Math.max(0,Math.round(r._parseStarSize(t._szStar)/e*n)),f-=t.renderWidth));return this._dirty=!0,this._update(),!0}return!1},t}(u);t.ColumnCollection=s;h=function(t){function i(){t.apply(this,arguments);this._maxLevel=-1}return __extends(i,t),Object.defineProperty(i.prototype,"maxGroupLevel",{get:function(){return this._update(),this._maxLevel},enumerable:!0,configurable:!0}),i.prototype._update=function(){var i,r;if(t.prototype._update.call(this)){for(this._maxLevel=-1,i=0;i<this.length;i++)r=n.tryCast(this[i],n.grid.GroupRow),r&&r.level>this._maxLevel&&(this._maxLevel=r.level);return!0}return!1},i}(u);t.RowCollection=h})(n.grid||(n.grid={}));var t=n.grid}(wijmo||(wijmo={})),function(n){(function(t){"use strict";var i=function(){function i(i,r){var o,s;if(this._row=-1,this._col=-1,this._edge=0,this._EDGESIZE=5,i instanceof t.FlexGrid)this._g=i;else if(i instanceof t.GridPanel)this._p=i,i=this._g=this._p.grid;else throw"First parameter should be a FlexGrid or GridPanel.";if(n.isNumber(r.pageX)&&n.isNumber(r.pageY))r=new n.Point(r.pageX,r.pageY);else if(!(r instanceof n.Point))throw"Second parameter should be a MouseEvent or wijmo.Point.";this._pt=r.clone();var h=i.controlRect,a=i.topLeftCells,v=i.headersVisibility,u=v&2?a.columns.getTotalSize():0,f=v&1?a.rows.getTotalSize():0,y=i.scrollPosition;if(r.x-=h.left,r.y-=h.top,this._g._rtl&&(r.x=h.width-r.x),this._p==null&&r.x>=0&&r.y>=0&&i.clientSize&&r.x<=i.clientSize.width+u&&r.y<=i.clientSize.height+f&&(this._p=r.x<=u&&r.y<=f?i.topLeftCells:r.x<=u?i.rowHeaders:r.y<=f?i.columnHeaders:i.cells),this._p!=null){var c=this._p.rows,l=this._p.columns,e=this._p.cellType,p=this._p._getFrozenPos();if((e==1||e==3)&&(r.y-=f,r.y>p.y&&(r.y=r.y-y.y+this._p._getOffsetY())),(e==1||e==2)&&(r.x-=u,r.x>p.x&&(r.x-=y.x)),this._row=r.y>c.getTotalSize()?-1:c.getItemAt(r.y),this._col=r.x>l.getTotalSize()?-1:l.getItemAt(r.x),this._row<0||this._col<0){this._p=null;return}this._edge=0;this._col>-1&&(o=l[this._col],r.x-o.pos-r.x<=this._EDGESIZE&&(this._edge|=1),o.pos+o.renderSize-r.x<=this._EDGESIZE&&(this._edge|=4));this._row>-1&&(s=c[this._row],r.y-s.pos-r.y<=this._EDGESIZE&&(this._edge|=2),s.pos+s.renderSize-r.y<=this._EDGESIZE&&(this._edge|=8))}}return Object.defineProperty(i.prototype,"point",{get:function(){return this._pt},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"cellType",{get:function(){return this._p?this._p.cellType:0},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"gridPanel",{get:function(){return this._p},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"row",{get:function(){return this._row},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"col",{get:function(){return this._col},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"cellRange",{get:function(){return new t.CellRange(this._row,this._col)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"edgeLeft",{get:function(){return(this._edge&1)!=0},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"edgeTop",{get:function(){return(this._edge&2)!=0},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"edgeRight",{get:function(){return(this._edge&4)!=0},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"edgeBottom",{get:function(){return(this._edge&8)!=0},enumerable:!0,configurable:!0}),i}();t.HitTestInfo=i})(n.grid||(n.grid={}));var t=n.grid}(wijmo||(wijmo={})),function(n){(function(t){"use strict";(function(n){n[n.None=0]="None";n[n.Cells=1]="Cells";n[n.ColumnHeaders=2]="ColumnHeaders";n[n.RowHeaders=4]="RowHeaders";n[n.AllHeaders=n.ColumnHeaders|n.RowHeaders]="AllHeaders";n[n.All=n.Cells|n.AllHeaders]="All"})(t.AllowMerging||(t.AllowMerging={}));var i=t.AllowMerging,r=function(){function r(n){this._g=n}return r.prototype.getMergedRange=function(r,u,f){var e,y,h=r.cellType,o=r.columns,s=r.rows,d=s[u],tt=o[f],v,g,b,l,a,nt,k,c,p,w;if(d instanceof t._NewRowTemplate)return null;if(d instanceof t.GroupRow&&d.dataItem instanceof n.collections.CollectionViewGroup&&(e=new t.CellRange(u,f),tt.aggregate==0)){while(e.col>0&&o[e.col-1].aggregate==0&&e.col!=o.frozen)e.col--;while(e.col2<o.length-1&&o[e.col2+1].aggregate==0&&e.col2+1!=o.frozen)e.col2++;return e}v=!1;switch(this._g.allowMerging){case 0:v=!0;break;case 1:v=h!=1;break;case 2:v=h!=2&&h!=4;break;case 4:v=h!=3&&h!=4;break;case i.AllHeaders:v=h==1}if(v)return null;if(o[f].allowMerging){for(e=new t.CellRange(u,f),g=0,b=s.length-1,u>=s.frozen?(h==1||h==3)&&(y=r._getViewRange(!0),g=y.topRow,b=y.bottomRow):b=s.frozen-1,c=r.getCellData(u,f,!0),l=u-1;c!=null&&l>=g;l--){if(s[l]instanceof t.GroupRow||s[l]instanceof t._NewRowTemplate||l==s.frozen||r.getCellData(l,f,!0)!==c)break;e.row=l}for(a=u+1;c!=null&&a<=b;a++){if(s[a]instanceof t.GroupRow||s[a]instanceof t._NewRowTemplate||a+1==s.frozen||r.getCellData(a,f,!0)!==c)break;e.row2=a}if(!e.isSingleCell)return e}if(s[u].allowMerging){for(e=new t.CellRange(u,f),nt=0,k=o.length-1,f>=o.frozen?(h==1||h==2)&&(y=r._getViewRange(!0),nt=y.leftCol,k=y.rightCol):k=o.frozen-1,c=r.getCellData(u,f,!0),p=f-1;p>=nt;p--){if(p==o.frozen||r.getCellData(u,p,!0)!==c)break;e.col=p}for(w=f+1;w<=k;w++){if(w==o.frozen||r.getCellData(u,w,!0)!==c)break;e.col2=w}if(!e.isSingleCell)return e}return null},r}();t.MergeManager=r})(n.grid||(n.grid={}));var t=n.grid}(wijmo||(wijmo={})),function(n){(function(t){"use strict";var i=function(){function t(t,i,r){var f,u;if(this.mapChanged=new n.Event,n.isArray(t)&&!i&&!r){for(f=[],u=0;u<t.length;u++)f.push({value:t[u]});t=f;i="value";r="value"}this._cv=n.asCollectionView(t);this._keyPath=n.asString(i,!1);this._displayPath=n.asString(r,!1);this._cv.collectionChanged.addHandler(this.onMapChanged,this)}return Object.defineProperty(t.prototype,"collectionView",{get:function(){return this._cv},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"selectedValuePath",{get:function(){return this._keyPath},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"displayMemberPath",{get:function(){return this._displayPath},enumerable:!0,configurable:!0}),t.prototype.getKeyValue=function(n){var t=this._indexOf(n,this._displayPath,!1);return t>-1?this._cv.sourceCollection[t][this._keyPath]:null},t.prototype.getDisplayValue=function(n){var t=this._indexOf(n,this._keyPath,!0);return t>-1?this._cv.sourceCollection[t][this._displayPath]:n},t.prototype.getDisplayValues=function(){var i=[],t,n;if(this._cv&&this._displayPath)for(t=this._cv.sourceCollection,n=0;n<t.length;n++)i.push(t[n][this._displayPath]);return i},t.prototype.onMapChanged=function(){this.mapChanged.raise(this)},t.prototype._indexOf=function(n,t,i){var f,r,u;if(this._cv&&t)for(i||(n=n.toString().toLowerCase()),f=this._cv.sourceCollection,r=0;r<f.length;r++)if((u=f[r][t],u==n)||!i&&u.length==n.length&&u.toLowerCase()==n)return r;return-1},t}();t.DataMap=i})(n.grid||(n.grid={}));var t=n.grid}(wijmo||(wijmo={})),function(n){(function(t){"use strict";var r,u,f,i;(function(n){n[n.None=0]="None";n[n.Cell=1]="Cell";n[n.CellRange=2]="CellRange";n[n.Row=3]="Row";n[n.RowRange=4]="RowRange";n[n.ListBox=5]="ListBox"})(t.SelectionMode||(t.SelectionMode={}));r=t.SelectionMode,function(n){n[n.None=0]="None";n[n.Selected=1]="Selected";n[n.Cursor=2]="Cursor"}(t.SelectedState||(t.SelectedState={}));u=t.SelectedState,function(n){n[n.None=0]="None";n[n.Next=1]="Next";n[n.Prev=2]="Prev";n[n.NextPage=3]="NextPage";n[n.PrevPage=4]="PrevPage";n[n.Home=5]="Home";n[n.End=6]="End";n[n.NextCell=7]="NextCell";n[n.PrevCell=8]="PrevCell"}(t.SelMove||(t.SelMove={}));f=t.SelMove;i=function(){function i(n){this._sel=new t.CellRange(0,0);this._mode=2;this._g=n}return Object.defineProperty(i.prototype,"selectionMode",{get:function(){return this._mode},set:function(n){var i,t;if(n!=this._mode){if(n==5||this._mode==5)for(i=this._g.rows,t=0;t<i.length;t++)i[t].isSelected=n==5?this._sel.containsRow(t):!1;this._mode=n;this._g.invalidate()}},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"selection",{get:function(){return this._sel},set:function(n){this.select(n)},enumerable:!0,configurable:!0}),i.prototype.getSelectedState=function(n,t){if(this._mode==0)return 0;var i=this._sel,r=this._g,u=r.getMergedRange(r.cells,n,t);if(u){if(u.contains(i.row,i.col))return 2;if(u.intersects(i))return 1}return i.row==n&&i.col==t?2:r.rows[n].isSelected||r.columns[t].isSelected?1:(i=this._adjustSelection(i),n<0&&i.containsColumn(t)||t<0&&i.containsRow(n))?1:this._mode==5?0:i.containsRow(n)&&i.containsColumn(t)?1:0},i.prototype.select=function(i,r){var o,e,s,c;typeof r=="undefined"&&(r=!0);n.isNumber(i)&&n.isNumber(r)&&(i=new t.CellRange(i,r),r=!0);i=n.asType(i,t.CellRange);var f=this._g,h=this._sel,u=i;switch(f.selectionMode){case 1:i.row2=i.row;i.col2=i.col;break;case 3:i.row2=i.row;break;case 5:for(o=f.rows,e=0;e<o.length;e++)o[e].isSelected=u.containsRow(e)}if(u.equals(h)){r&&f.scrollIntoView(u.row,u.col);return}if(s=new t.CellRangeEventArgs(f.cells,u),f.onSelectionChanging(s)){u.row=Math.min(u.row,f.rows.length-1);u.row2=Math.min(u.row2,f.rows.length-1);this._sel=u;f.refreshCells(!1,!0,[this._adjustSelection(h),this._adjustSelection(u)]);r&&f.scrollIntoView(u.row,u.col);f.collectionView&&(c=f._getCvIndex(u.row),f.collectionView.moveCurrentToPosition(c));f.onSelectionChanged(s)}},i.prototype.moveSelection=function(n,i,r){var f,u,s=this._g,c=s.rows,h=s.columns,e=this._getReferenceCell(n,i,r),o=Math.max(0,s.clientSize.height-s.columnHeaders.height),l;i==7?(u=h.getNextCell(e.col,1,o),f=e.row,u==e.col&&(f=c.getNextCell(f,1,o),f>e.row&&(u=h.getNextCell(0,1,o),u=h.getNextCell(u,2,o))),s.select(f,u)):i==8?(u=h.getNextCell(e.col,2,o),f=e.row,u==e.col&&(f=c.getNextCell(f,2,o),f<e.row&&(u=h.getNextCell(h.length-1,2,o),u=h.getNextCell(u,1,o))),s.select(f,u)):(f=c.getNextCell(e.row,n,o),u=h.getNextCell(e.col,i,o),r?(l=s.selection,s.select(new t.CellRange(f,u,l.row2,l.col2))):s.select(f,u))},i.prototype._getReferenceCell=function(n,t){var u=this._g,r=u.selection,i=r;if(u.mergeManager&&(i=u.mergeManager.getMergedRange(u.cells,r.row,r.col)),!u.mergeManager||!i||i.isSingleCell)return r;switch(n){case 1:case 7:i.row=i.bottomRow;break;case 0:i.row=r.row}switch(t){case 1:case 7:i.col=i.rightCol;break;case 0:i.col=r.col}return i},i.prototype._adjustSelection=function(n){switch(this._mode){case 1:return new t.CellRange(n.row,n.col,n.row,n.col);case 3:return new t.CellRange(n.row,0,n.row,this._g.columns.length-1);case 4:case 5:return new t.CellRange(n.row,0,n.row2,this._g.columns.length-1)}return n},i}();t._SelectionHandler=i})(n.grid||(n.grid={}));var t=n.grid}(wijmo||(wijmo={})),function(n){(function(t){"use strict";var i=function(){function i(n){this._g=n;var t=n.hostElement;t.addEventListener("keypress",this._keyPress.bind(this));t.addEventListener("keydown",this._keyDown.bind(this))}return i.prototype._keyDown=function(i){var r=this._g,f=r.selection,c=i.ctrlKey,u=i.shiftKey,s=!0,a,h;if(r.isRangeValid(f)&&!i.defaultPrevented){if(r.activeEditor&&r._edtHdl._keyDown(i))return;var o=n.tryCast(r.rows[f.row],t.GroupRow),e=n.tryCast(r.collectionView,"IEditableCollectionView"),l=i.keyCode;if(r.autoClipboard){if(i.ctrlKey&&(i.keyCode==67||i.keyCode==45)){if(h=new t.CellRangeEventArgs(r.cells,f),r.onCopying(h)){a=r.getClipString();n.Clipboard.copy(a);r.onCopied(h)}return}if(i.ctrlKey&&i.keyCode==86||i.shiftKey&&i.keyCode==45){r.isReadOnly||(h=new t.CellRangeEventArgs(r.cells,f),r.onPasting(h)&&n.Clipboard.paste(function(n){r.setClipString(n);r.onPasted(h)}));return}}if(r._rtl)switch(l){case 37:l=39;break;case 39:l=37}switch(l){case 37:f.isValid&&f.col==0&&o!=null&&!o.isCollapsed&&o.hasChildren?o.isCollapsed=!0:this._moveSel(0,c?5:2,u);break;case 39:f.isValid&&f.col==0&&o!=null&&o.isCollapsed?o.isCollapsed=!1:this._moveSel(0,c?6:1,u);break;case 38:this._moveSel(c?5:2,0,u);break;case 40:this._moveSel(c?6:1,0,u);break;case 33:this._moveSel(4,0,u);break;case 34:this._moveSel(3,0,u);break;case 36:this._moveSel(0,5,u);break;case 35:this._moveSel(0,6,u);break;case 9:this._moveSel(0,u?8:7,u);break;case 13:this._moveSel(1,0,u);e&&e.currentEditItem!=null&&e.commitEdit();break;case 27:e&&(e.currentEditItem!=null&&e.cancelEdit(),e.currentAddItem!=null&&e.cancelNew());break;case 46:s=this._deleteSel();break;case 113:s=r.startEditing(!0);break;case 32:s=r.startEditing(!0);s&&setTimeout(function(){var n=r.activeEditor,t;n&&(n.type=="checkbox"?(n.checked=!n.checked,r.finishEditing()):(t=n.value.length,n.setSelectionRange(t,t)))},0);break;default:s=!1}s&&(i.preventDefault(),i.stopPropagation())}},i.prototype._keyPress=function(n){var t=this._g;t.activeEditor?t._edtHdl._keyPress(n):n.charCode>32&&t.startEditing(!1)&&t.activeEditor&&(t.columns[t.editRange.col].mask||setTimeout(function(){var i=t.activeEditor;i&&i.type!="checkbox"&&(i.value=String.fromCharCode(n.charCode),i.setSelectionRange(1,1),t._edtHdl._keyPress(n))},0))},i.prototype._moveSel=function(n,t,i){this._g.selectionMode!=0&&this._g._selHdl.moveSelection(n,t,i)},i.prototype._deleteSel=function(){var i=this._g,f=n.tryCast(i.collectionView,"IEditableCollectionView"),u=i.selection,o=i.rows,e=[],h,l,r,s,c;if(i.allowDelete&&!i.isReadOnly&&(f==null||f.canRemove&&!f.isAddingNew&&!f.isEditingItem))switch(i.selectionMode){case 2:if(u.leftCol==0&&u.rightCol==i.columns.length-1)for(r=u.topRow;r>-1&&r<=u.bottomRow;r++)e.push(o[r]);break;case 5:for(r=0;r<o.length;r++)o[r].isSelected&&e.push(o[r]);break;case 3:u.topRow>-1&&e.push(o[u.topRow]);break;case 4:for(r=u.topRow;r>-1&&r<=u.bottomRow;r++)e.push(o[r])}if(e.length>0){for(f&&f.beginUpdate(),i.beginUpdate(),h=new t.CellRange,l=new t.CellRangeEventArgs(i.cells,h),r=e.length-1;r>=0;r--){s=e[r];h.row=h.row2=s.index;i.onDeletingRow(l);l.cancel||(f&&s.dataItem?f.remove(s.dataItem):i.rows.removeAt(s.index))}return i.endUpdate(),f&&f.endUpdate(),i.selectionMode==5&&(c=i.selection.row,c>-1&&c<i.rows.length&&(i.rows[c].isSelected=!0)),i.childItemsPath&&i.collectionView&&i.collectionView.refresh(),!0}return!i.isReadOnly&&e.length==0&&u.isSingleCell&&i.getCellData(u.row,u.col,!0)&&i.startEditing(!1,u.row,u.col)&&(i.finishEditing(!0),i.setCellData(u.row,u.col,"",!0))?(i.invalidate(),!0):!1},i}();t._KeyboardHandler=i})(n.grid||(n.grid={}));var t=n.grid}(wijmo||(wijmo={})),function(n){(function(t){"use strict";var r,u,i;(function(n){n[n.None=0]="None";n[n.Columns=1]="Columns";n[n.Rows=2]="Rows";n[n.Both=n.Rows|n.Columns]="Both"})(t.AllowResizing||(t.AllowResizing={}));r=t.AllowResizing,function(n){n[n.None=0]="None";n[n.Columns=1]="Columns";n[n.Rows=2]="Rows";n[n.Both=n.Rows|n.Columns]="Both"}(t.AllowDragging||(t.AllowDragging={}));u=t.AllowDragging;i=function(){function i(n){var t,i,r,u;this._g=n;t=n.hostElement;i=this;t.addEventListener("mousedown",function(n){document.addEventListener("mousemove",r);document.addEventListener("mouseup",u);i._mouseDown(n)});r=function(n){i._mouseMove(n)};u=function(n){document.removeEventListener("mousemove",r);document.removeEventListener("mouseup",u);i._mouseUp(n)};t.addEventListener("mousemove",this._hover.bind(this));t.addEventListener("dblclick",this._dblClick.bind(this));t.addEventListener("dragstart",this._dragStart.bind(this));t.addEventListener("dragover",this._dragOver.bind(this));t.addEventListener("drop",this._drop.bind(this));t.addEventListener("dragend",this._dragEnd.bind(this))}return i.prototype.resetMouseState=function(){this._dragSource&&(this._dragSource.style.opacity=1);this._htDown=null;this._lbSelRows=null;this._szRowCol=null;this._szArgs=null;this._dragSource=null;this._g.hostElement.style.cursor="default"},i.prototype._mouseDown=function(i){var r=this._g,u=r.hitTest(i),f,e;if(!i.defaultPrevented&&u.cellType!=0&&(!r.editRange||!r.editRange.contains(u.cellRange))){if(this._htDown=u,this._eMouse=i,r.containsFocus()||r.focus(),this._szRowCol!=null){this._handleResizing(i);return}switch(u.cellType){case 1:i.ctrlKey&&r.selectionMode==5&&this._startListBoxSelection(u.row);this._mouseSelect(i,i.shiftKey);break;case 3:(this._g.allowDragging&2)==0&&(i.ctrlKey&&r.selectionMode==5&&this._startListBoxSelection(u.row),this._mouseSelect(i,i.shiftKey))}if(u.cellType==1&&u.col==r.columns.firstVisibleIndex&&(f=n.tryCast(r.rows[u.row],t.GroupRow),f&&(e=document.elementFromPoint(i.clientX,i.clientY),r._hasAttribute(e,t.CellFactory._WJA_COLLAPSE)))){i.ctrlKey?r.collapseGroupsToLevel(f.isCollapsed?f.level+1:f.level):f.isCollapsed=!f.isCollapsed;this.resetMouseState();i.preventDefault();return}}},i.prototype._mouseMove=function(n){if(this._htDown!=null)if(this._eMouse=n,this._szRowCol)this._handleResizing(n);else switch(this._htDown.cellType){case 1:this._mouseSelect(n,!0);break;case 3:(this._g.allowDragging&2)==0&&this._mouseSelect(n,!0)}},i.prototype._mouseUp=function(n){this._szArgs?this._finishResizing():this._handleSort(n);this.resetMouseState()},i.prototype._dblClick=function(n){var i=this._g,r=i.hitTest(n),s=i.selection,f=r.cellRange,u,e,o;if(!n.defaultPrevented){if(r.edgeRight&&i.allowResizing&1){if(r.cellType==2){for(n.ctrlKey&&s.containsColumn(r.col)&&(f=s),e=f.leftCol;e<=f.rightCol;e++)if(i.columns[e].allowResizing&&(u=new t.CellRangeEventArgs(i.cells,new t.CellRange(-1,e)),i.onResizingColumn(u))){i.autoSizeColumn(e);i.onResizedColumn(u)}}else if(r.cellType==4&&i.topLeftCells.columns[r.col].allowResizing&&(u=new t.CellRangeEventArgs(i.topLeftCells,new t.CellRange(-1,r.col)),i.onResizingColumn(u))){i.autoSizeColumn(r.col,!0);i.onResizedColumn(u)}return}if(r.edgeBottom&&i.allowResizing&2)if(r.cellType==3){for(n.ctrlKey&&s.containsRow(r.row)&&(f=s),o=f.topRow;o<=f.bottomRow;o++)if(i.rows[o].allowResizing&&(u=new t.CellRangeEventArgs(i.cells,new t.CellRange(o,-1)),i.onResizingRow(u))){i.autoSizeRow(o);i.onResizedRow(u)}}else if(r.cellType==4&&i.topLeftCells.rows[r.row].allowResizing&&(u=new t.CellRangeEventArgs(i.topLeftCells,new t.CellRange(r.row,-1)),i.onResizingRow(u))){i.autoSizeRow(r.row,!0);i.onResizedRow(u)}}},i.prototype._hover=function(n){if(this._htDown==null){var r=this._g,i=r.hitTest(n),u=i.gridPanel,f="default";this._szRowCol=null;(i.cellType==2||i.cellType==4)&&r.allowResizing&1&&i.edgeRight&&u.columns[i.col].allowResizing&&(this._szRowCol=u.columns[i.col]);(i.cellType==3||i.cellType==4)&&r.allowResizing&2&&i.edgeBottom&&u.rows[i.row].allowResizing&&(this._szRowCol=u.rows[i.row]);this._szRowCol instanceof t.Column?f="e-resize":this._szRowCol instanceof t.Row&&(f="s-resize");this._szStart=this._szRowCol?this._szRowCol.renderSize:0;r.hostElement.style.cursor=f}},i.prototype._mouseSelect=function(n,i){var f,r,u;this._htDown&&this._htDown.gridPanel&&this._g.selectionMode!=0&&(f=this._g,r=new t.HitTestInfo(this._htDown.gridPanel,n),n.preventDefault(),this._handleSelection(r,i),r=new t.HitTestInfo(f,n),r.cellType!=1&&r.cellType!=3&&(u=this,setTimeout(function(){u._mouseSelect(u._eMouse,i)},0)))},i.prototype._handleResizing=function(n){var i;if(n.preventDefault(),this._szRowCol instanceof t.Column&&(i=Math.max(1,this._szStart+(n.pageX-this._htDown.point.x)*(this._g._rtl?-1:1)),this._szRowCol.renderSize!=i)){this._szArgs==null&&(this._szArgs=new t.CellRangeEventArgs(this._htDown.gridPanel,new t.CellRange(-1,this._szRowCol.index)));this._g.onResizingColumn(this._szArgs);this._szRowCol.width=i}if(this._szRowCol instanceof t.Row&&(i=Math.max(1,this._szStart+(n.pageY-this._htDown.point.y)),this._szRowCol.renderSize!=i)){this._szArgs==null&&(this._szArgs=new t.CellRangeEventArgs(this._htDown.gridPanel,new t.CellRange(this._szRowCol.index,-1)));this._g.onResizingRow(this._szArgs);this._szRowCol.height=i}},i.prototype._dragStart=function(n){var r=this._g,i=this._htDown,u;i&&(this._dragSource=null,this._szRowCol||(u=new t.CellRangeEventArgs(r.cells,i.cellRange),i.cellType==2&&r.allowDragging&1&&i.col>-1&&r.columns[i.col].allowDragging?r.onDraggingColumn(u)&&(this._dragSource=n.target):i.cellType==3&&r.allowDragging&2&&i.row>-1&&r.rows[i.row].allowDragging&&r.onDraggingRow(u)&&(this._dragSource=n.target)),this._dragSource&&n.dataTransfer?(n.dataTransfer.effectAllowed="move",n.dataTransfer.setData("text",""),this._dragSource.style.opacity=.5):n.preventDefault())},i.prototype._dragEnd=function(){this.resetMouseState()},i.prototype._dragOver=function(n){var i=this._g,t=i.hitTest(n),r=!1;this._htDown&&t.cellType==this._htDown.cellType&&(t.cellType==2?r=i.columns.canMoveElement(this._htDown.col,t.col):t.cellType==3&&(r=i.rows.canMoveElement(this._htDown.row,t.row)));r&&(n.dataTransfer.dropEffect="move",n.preventDefault())},i.prototype._drop=function(n){var i=this._g,r=i.hitTest(n),f=new t.CellRangeEventArgs(i.cells,r.cellRange),u;if(this._htDown&&r.cellType==this._htDown.cellType)if(u=i.selection,r.cellType==2){i.columns.moveElement(this._htDown.col,r.col);i.select(u.row,r.col);i.onDraggedColumn(f)}else if(r.cellType==3){i.rows.moveElement(this._htDown.row,r.row);i.select(r.row,u.col);i.onDraggedRow(f)}this.resetMouseState()},i.prototype._finishResizing=function(){var i=this._g,e=i.selection,o=this._eMouse.ctrlKey,n=this._szArgs,r,u,f;if(n&&n.row>-1){i.onResizedRow(n);if(r=n.row,o&&this._htDown.cellType!=4&&e.containsRow(r))for(u=e.topRow;u<=e.bottomRow;u++)if(i.rows[u].allowResizing&&u!=r){n=new t.CellRangeEventArgs(i.cells,new t.CellRange(u,-1));i.onResizingRow(n);if(!n.cancel){i.rows[u].size=i.rows[r].size;i.onResizedRow(n)}}}if(n&&n.col>-1){i.onResizedColumn(n);if(r=n.col,o&&this._htDown.cellType!=4&&e.containsColumn(r))for(f=e.leftCol;f<=e.rightCol;f++)if(i.columns[f].allowResizing&&f!=r){n=new t.CellRangeEventArgs(i.cells,new t.CellRange(-1,f));i.onResizingColumn(n);if(!n.cancel){i.columns[f].size=i.columns[r].size;i.onResizedColumn(n)}}}},i.prototype._startListBoxSelection=function(n){var i=this._g.rows,t;for(this._lbSelState=!i[n].isSelected,this._lbSelRows={},t=0;t<i.length;t++)i[t].isSelected&&(this._lbSelRows[t]=!0)},i.prototype._handleSelection=function(n,i){var e=this,u=this._g,s=u.rows,o=u.selection,f=new t.CellRange(n.row,n.col),h,c,r;if(n.row>-1&&n.col>-1)if(this._lbSelRows!=null){for(f=new t.CellRange(n.row,n.col,e._htDown.row,e._htDown.col),r=0;r<s.length;r++)if(h=f.containsRow(r)?e._lbSelState:e._lbSelRows[r]!=null,h!=s[r].isSelected&&(c=new t.CellRangeEventArgs(u.cells,new t.CellRange(r,o.col,r,o.col2)),u.onSelectionChanging(c))){s[r].isSelected=h;u.onSelectionChanged(c)}u.scrollIntoView(n.row,n.col)}else n.cellType==3&&(f.col=0,f.col2=u.columns.length-1),i&&(f.row2=o.row2,f.col2=o.col2),u.select(f)},i.prototype._handleSort=function(i){var u=this._g,o=u.collectionView,r=u.hitTest(i),s,e;if(this._htDown&&r.cellType==this._htDown.cellType&&r.col==this._htDown.col&&r.cellType==2&&!r.edgeRight&&r.row==this._g.columnHeaders.rows.length-1&&r.col>-1&&o&&o.canSort&&u.allowSorting){var f=u.columns[r.col],h=f.currentSort,c=h!="+";if(f.allowSorting&&f.binding){if(!h&&i.ctrlKey)return;if(s=new t.CellRangeEventArgs(u.columnHeaders,new t.CellRange(-1,r.col)),u.onSortingColumn(s)){e=o.sortDescriptions;i.ctrlKey?e.clear():e.splice(0,e.length,new n.collections.SortDescription(f.binding,c));u.onSortedColumn(s)}}}},i}();t._MouseHandler=i})(n.grid||(n.grid={}));var t=n.grid}(wijmo||(wijmo={})),function(n){(function(t){"use strict";var i=function(){function i(i){this._fullEdit=!1;this._list=null;this._g=i;var r=this;this._evtInput=document.createEvent("HTMLEvents");this._evtInput.initEvent("input",!0,!1);i.selectionChanging.addHandler(function(n,t){r.finishEditing();t.row!=i.selection.row&&r._commitRowEdits()});i.hostElement.addEventListener("focusout",function(){setTimeout(function(){var n=i.activeEditor,t=document.activeElement;if(n&&n.type!="checkbox"&&t&&t.tagName=="BODY"){n.setSelectionRange(0,n.value.length);return}i.containsFocus()||r._commitRowEdits()},0)});i.scrollPositionChanged.addHandler(function(){r.finishEditing()});i.hostElement.addEventListener("mousedown",function(u){var o=i.selection,e=i.hitTest(u),f,s;if(r._htDown=null,e.cellType!=1)r._lbx&&n.contains(r._lbx.hostElement,u.target)||r._commitRowEdits();else{if(f=n.tryCast(u.target,HTMLInputElement),f&&f.type=="checkbox"&&n.hasClass(f.parentElement,"wj-cell")&&(f!=r.activeEditor?(u.preventDefault(),r.startEditing(!1,e.row,e.col),setTimeout(function(){f=r.activeEditor;f&&f.type=="checkbox"&&(f.checked=!f.checked,r.finishEditing())},0)):r.finishEditing()),s=document.elementFromPoint(u.clientX,u.clientY),i._hasAttribute(s,t.CellFactory._WJA_DROPDOWN)){r._toggleDropDown(e);r._htDown=null;u.preventDefault();return}f==null&&e.row==o.row&&e.col==o.col&&(r._htDown=e)}},!0);i.hostElement.addEventListener("click",function(n){if(r._htDown&&!r.activeEditor){var t=i.hitTest(n);t.cellRange.equals(r._htDown.cellRange)&&r.startEditing(!0,t.row,t.col)}});window.addEventListener("scroll",function(){r._removeListBox()});document.body.addEventListener("wheel",function(n){var i,t;if(r._lbx){for(i=r._lbx.hostElement,t=n.target;t;t=t.parentElement)if(t==i)return;r._removeListBox()}})}return i.prototype.startEditing=function(i,r,u){var f,o,s,h,l,c,e;if(typeof i=="undefined"&&(i=!0),f=this._g,r=n.asNumber(r,!0,!0),u=n.asNumber(u,!0,!0),r==null&&(r=f.selection.row),u==null&&(u=f.selection.col),!this._allowEditing(r,u))return!1;if(o=f.getMergedRange(f.cells,r,u),o||(o=new t.CellRange(r,u)),f.select(o,!0),o.equals(this._rng))return!0;if(s=new t.CellRangeEventArgs(f.cells,o),!f.onBeginningEdit(s))return!1;if(h=n.tryCast(f.collectionView,"IEditableCollectionView"),h&&(l=f.rows[r].dataItem,h.editItem(l)),this._fullEdit=i,this._rng=o,this._list=null,c=f.columns[u].dataMap,c&&(this._list=c.getDisplayValues()),f.refresh(!1),e=this._edt,e){e.type=="checkbox"?this._fullEdit=!1:e.setSelectionRange(0,e.value.length);f.onPrepareCellForEdit(s);e=this._edt;e&&e.focus()}return!0},i.prototype.finishEditing=function(n){var i,s,f,e;if(typeof n=="undefined"&&(n=!1),this._removeListBox(),i=this._edt,!i)return!0;var r=this._g,u=this._rng,o=new t.CellRangeEventArgs(r.cells,u);r.onCellEditEnding(o);if(!n&&!o.cancel)for(s=i.type=="checkbox"?i.checked:i.value,f=u.topRow;f<=u.bottomRow;f++)for(e=u.leftCol;e<=u.rightCol;e++)r.cells.setCellData(f,e,s,!0);this._edt=null;this._rng=null;this._list=null;r.refresh(!1);r.onCellEditEnded(o);return!0},Object.defineProperty(i.prototype,"activeEditor",{get:function(){return this._edt},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"editRange",{get:function(){return this._rng},enumerable:!0,configurable:!0}),i.prototype._allowEditing=function(n,t){var i=this._g;return i.isReadOnly||i.selectionMode==0?!1:n<0||n>=i.rows.length||i.rows[n].isReadOnly?!1:t<0||t>=i.columns.length||i.columns[t].isReadOnly?!1:!0},i.prototype._commitRowEdits=function(){var i,r,u;if(this.finishEditing(),i=this._g,r=n.tryCast(i.collectionView,"IEditableCollectionView"),r&&r.currentEditItem){u=new t.CellRangeEventArgs(i.cells,i.selection);i.onRowEditEnding(u);r.commitEdit();i.onRowEditEnded(u)}},i.prototype._keyDown=function(n){switch(n.keyCode){case 113:return this._fullEdit=!this._fullEdit,n.preventDefault(),!0;case 32:var t=this._edt;return t&&t.type=="checkbox"&&(t.checked=!t.checked,this.finishEditing(),n.preventDefault()),!0;case 13:case 9:return this.finishEditing(),!1;case 27:return this.finishEditing(!0),!0;case 38:case 40:case 37:case 39:case 33:case 34:case 36:case 35:if(!this._fullEdit)return this.finishEditing(),!1}return!0},i.prototype._keyPress=function(n){var t=this._edt,u,i,r;if(t&&t.type!="checkbox"&&this._list&&this._list.length>0)for(u=t.selectionStart,i=t.value,i=i.substr(0,u),n.target==t&&(u++,i+=String.fromCharCode(n.charCode)),i=i.toLowerCase(),r=0;r<this._list.length;r++)if(this._list[r].toLowerCase().indexOf(i)==0){t.value=this._list[r];t.setSelectionRange(u,this._list[r].length);n.preventDefault();break}},i.prototype._toggleDropDown=function(t){if(this._lbx&&(this._removeListBox(),this._g.selection.contains(t.cellRange))){this._g.activeEditor?this._g.activeEditor.focus():this._g.focus();return}if(n.input&&this.startEditing(!0,t.row,t.col)){this._lbx=this._createListBox();this._lbx.showSelection();this._lbx.focus();var i=this,r=this._g;this._lbx.selectedIndexChanged.addHandler(function(){var n=r.activeEditor;n&&(n.value=i._lbx.selectedValue,n.setSelectionRange(0,n.value.length),n.dispatchEvent(i._evtInput));i._removeListBox()});this._lbx.hostElement.addEventListener("mousedown",function(n){n.stopPropagation()});this._lbx.hostElement.addEventListener("blur",function(){i._lbx&&!i._lbx.containsFocus()&&i._removeListBox()})}},i.prototype._createListBox=function(){var t=this._g,u=this._rng,h=t.activeEditor?t.activeEditor.value:t.getCellData(u.row,u.col,!0),s=t.rows[u.row],c=t.columns[u.col],l=c.dataMap.getDisplayValues(),f=document.createElement("div"),e=new n.input.ListBox(f),o,i,r;for(e.itemsSource=l,e.selectedValue=h,e.maxHeight=s.renderHeight*4,o=t.hostElement,i=o;i;i=i.parentElement)if(getComputedStyle(i).position=="fixed"){o=i;break}return o.appendChild(f),r=t.activeEditor.getBoundingClientRect(),n.setCss(f,{position:"fixed",zIndex:100,minWidth:r.width+17,left:r.left,top:r.top<innerHeight/2?Math.round(r.top+s.renderHeight):Math.round(r.top-f.offsetHeight)}),e},i.prototype._removeListBox=function(){var t=this._lbx,n;t&&(this._lbx=null,n=t.hostElement,n.parentElement.removeChild(n))},i}();t._EditHandler=i})(n.grid||(n.grid={}));var t=n.grid}(wijmo||(wijmo={}));__extends=this.__extends||function(n,t){function r(){this.constructor=n}for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);r.prototype=t.prototype;n.prototype=new r},function(n){(function(t){"use strict";var r=function(){function t(n){this._nrt=new i;this._g=n;n.beginningEdit.addHandler(this._beginningEdit,this);n.rowEditEnded.addHandler(this._rowEditEnded,this);n.loadedRows.addHandler(this.updateNewRowTemplate,this)}return t.prototype.updateNewRowTemplate=function(){var u=n.tryCast(this._g.collectionView,"IEditableCollectionView"),r=this._g,t=r.rows,f=u&&u.canAddNew&&r.allowAddNew&&!r.isReadOnly,i=t.indexOf(this._nrt);!f&&i>-1?t.removeAt(i):f&&(i<0?t.push(this._nrt):i!=t.length-1&&(t.removeAt(i),t.push(this._nrt)),this._nrt&&this._nrt._setFlag(128,!1))},t.prototype._beginningEdit=function(t,r){var f,u,e;if(!r.cancel&&(f=this._g.rows[r.row],n.tryCast(f,i)&&(u=n.tryCast(this._g.collectionView,"IEditableCollectionView"),u&&u.canAddNew))){e=u.isAddingNew?u.currentAddItem:u.addNew();u.moveCurrentTo(e);this.updateNewRowTemplate();this._g.refresh(!0);this._g.onRowAdded(r);r.cancel&&u.cancelNew()}},t.prototype._rowEditEnded=function(){var t=n.tryCast(this._g.collectionView,"IEditableCollectionView");t&&t.isAddingNew&&t.commitNew()},t}(),i;t._AddNewHandler=r;i=function(n){function t(){n.apply(this,arguments)}return __extends(t,n),t}(t.Row);t._NewRowTemplate=i})(n.grid||(n.grid={}));var t=n.grid}(wijmo||(wijmo={}))